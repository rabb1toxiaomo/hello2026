#!/bin/bash

# 腾讯云安全组端口开放脚本（使用腾讯云 CLI）
# 需要先安装腾讯云 CLI: https://cloud.tencent.com/document/product/440/34011

echo "=========================================="
echo "🔥 腾讯云安全组端口配置脚本"
echo "=========================================="
echo ""
echo "⚠️  注意：此脚本需要安装腾讯云 CLI 工具"
echo "如果未安装，请使用控制台手动配置"
echo ""
echo "需要配置的端口："
echo "  • 22   (SSH)"
echo "  • 80   (HTTP)"
echo "  • 443  (HTTPS)"
echo "  • 2026 (应用端口)"
echo ""
echo "=========================================="
echo ""
echo "请按照以下步骤在腾讯云控制台配置："
echo ""
echo "1. 登录腾讯云控制台: https://console.cloud.tencent.com/"
echo "2. 进入: 云服务器 CVM → 实例列表"
echo "3. 点击你的服务器实例"
echo "4. 点击 '安全组' 标签页"
echo "5. 点击安全组ID进入详情"
echo "6. 点击 '入站规则' → '添加规则'"
echo "7. 添加以下规则："
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "规则1: SSH (22端口)"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "类型:     自定义"
echo "来源:     0.0.0.0/0"
echo "协议端口: TCP:22"
echo "策略:     允许"
echo "备注:     SSH远程登录"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "规则2: HTTP (80端口)"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "类型:     自定义"
echo "来源:     0.0.0.0/0"
echo "协议端口: TCP:80"
echo "策略:     允许"
echo "备注:     HTTP访问"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "规则3: HTTPS (443端口)"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "类型:     自定义"
echo "来源:     0.0.0.0/0"
echo "协议端口: TCP:443"
echo "策略:     允许"
echo "备注:     HTTPS访问"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "规则4: 应用端口 (2026端口)"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "类型:     自定义"
echo "来源:     0.0.0.0/0"
echo "协议端口: TCP:2026"
echo "策略:     允许"
echo "备注:     应用服务端口"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "✅ 配置完成后，规则立即生效"
echo ""
echo "📝 验证端口是否开放："
echo "  在本地执行: telnet 154.8.235.129 80"
echo "  或在服务器执行: sudo netstat -tlnp | grep -E '(80|443|2026)'"
echo ""

